{{ config(materialized = 'table', tags=["staging_collections"], order_by='collection_id,post_short_code,stats_date') }}
with
ia_ts as (
    select
        platform,
        post_short_code,
        post_type,
        post_collection_item_id,
        post_title,
        post_link,
        post_thumbnail,
        hashtags,
        keywords,
        published_at,
        profile_social_id,
        profile_handle,
        post_handle,
        profile_name,
        collection_type,
        collection_id,
        followers,
        link_clicks,
        orders,
        delivered_orders,
        completed_orders,
        leaderboard_overall_orders,
        leaderboard_delivered_orders,
        leaderboard_completed_orders,
        stats_date,
        views,
        likes,
        comments,
        impressions,
        saves,
        plays,
        reach,
        swipe_ups,
        mentions,
        sticker_taps,
        shares,
        story_exits,
        story_back_taps,
        story_forward_taps,
        total_engagement,
        engagement_rate,
        real_reach,
        real_impressions,
        updated_at
    from {{ ref('mart_staging_post_collection_ia_post_ts') }}
),
ya_ts as (
    select
        platform,
        post_short_code,
        post_type,
        post_collection_item_id,
        post_title,
        post_link,
        post_thumbnail,
        hashtags,
        keywords,
        published_at,
        profile_social_id,
        profile_handle,
        post_handle,
        profile_name,
        collection_type,
        collection_id,
        followers,
        link_clicks,
        orders,
        delivered_orders,
        completed_orders,
        leaderboard_overall_orders,
        leaderboard_delivered_orders,
        leaderboard_completed_orders,
        stats_date,
        views,
        likes,
        comments,
        impressions,
        saves,
        plays,
        reach,
        swipe_ups,
        mentions,
        sticker_taps,
        shares,
        story_exits,
        story_back_taps,
        story_forward_taps,
        total_engagement,
        engagement_rate,
        real_reach,
        real_impressions,
        updated_at
    from {{ ref('mart_staging_post_collection_yt_post_ts') }}
)
select * from ia_ts
    union all
select * from ya_ts